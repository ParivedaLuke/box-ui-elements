/**
 * 
 * @file Function to sort the item list
 * @author Box
 */

import comparator from './comparator';
import getBadItemError from './error';


function isSortingNeeded(order, sortBy, sortDirection) {
    return !Array.isArray(order) || !order.some(function (entry) {
        return entry.by === sortBy && entry.direction === sortDirection;
    });
}

/**
 * Sorts items in place
 *
 * @param {Object} item box item object
 * @param {string} sortBy sort by field
 * @param {string} sortDirection the sort direction
 * @param {Cache} cache item cache
 * @return {void}
 */
export default function (item, sortBy, sortDirection, cache) {
    var item_collection = item.item_collection;

    if (!item_collection) {
        throw getBadItemError();
    }

    var entries = item_collection.entries,
        order = item_collection.order;

    if (!Array.isArray(entries)) {
        throw getBadItemError();
    }

    if (isSortingNeeded(order, sortBy, sortDirection)) {
        entries.sort(comparator(sortBy, sortDirection, cache));
        item_collection.order = [{
            by: sortBy,
            direction: sortDirection
        }];
    }
    return item;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNvcnRlci5qcyJdLCJuYW1lcyI6WyJjb21wYXJhdG9yIiwiZ2V0QmFkSXRlbUVycm9yIiwiaXNTb3J0aW5nTmVlZGVkIiwib3JkZXIiLCJzb3J0QnkiLCJzb3J0RGlyZWN0aW9uIiwiQXJyYXkiLCJpc0FycmF5Iiwic29tZSIsImVudHJ5IiwiYnkiLCJkaXJlY3Rpb24iLCJpdGVtIiwiY2FjaGUiLCJpdGVtX2NvbGxlY3Rpb24iLCJlbnRyaWVzIiwic29ydCJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7OztBQU1BLE9BQU9BLFVBQVAsTUFBdUIsY0FBdkI7QUFDQSxPQUFPQyxlQUFQLE1BQTRCLFNBQTVCOzs7QUFJQSxTQUFTQyxlQUFULENBQXlCQyxLQUF6QixFQUEwQ0MsTUFBMUMsRUFBMERDLGFBQTFELEVBQWlHO0FBQzdGLFdBQU8sQ0FBQ0MsTUFBTUMsT0FBTixDQUFjSixLQUFkLENBQUQsSUFBeUIsQ0FBQ0EsTUFBTUssSUFBTixDQUFXLFVBQUNDLEtBQUQ7QUFBQSxlQUFXQSxNQUFNQyxFQUFOLEtBQWFOLE1BQWIsSUFBdUJLLE1BQU1FLFNBQU4sS0FBb0JOLGFBQXREO0FBQUEsS0FBWCxDQUFqQztBQUNIOztBQUVEOzs7Ozs7Ozs7QUFTQSxlQUFlLFVBQ1hPLElBRFcsRUFFWFIsTUFGVyxFQUdYQyxhQUhXLEVBSVhRLEtBSlcsRUFLSztBQUFBLFFBQ1JDLGVBRFEsR0FDOEJGLElBRDlCLENBQ1JFLGVBRFE7O0FBRWhCLFFBQUksQ0FBQ0EsZUFBTCxFQUFzQjtBQUNsQixjQUFNYixpQkFBTjtBQUNIOztBQUplLFFBTVJjLE9BTlEsR0FNdUNELGVBTnZDLENBTVJDLE9BTlE7QUFBQSxRQU1DWixLQU5ELEdBTXVDVyxlQU52QyxDQU1DWCxLQU5EOztBQU9oQixRQUFJLENBQUNHLE1BQU1DLE9BQU4sQ0FBY1EsT0FBZCxDQUFMLEVBQTZCO0FBQ3pCLGNBQU1kLGlCQUFOO0FBQ0g7O0FBRUQsUUFBSUMsZ0JBQWdCQyxLQUFoQixFQUF1QkMsTUFBdkIsRUFBK0JDLGFBQS9CLENBQUosRUFBbUQ7QUFDL0NVLGdCQUFRQyxJQUFSLENBQWFoQixXQUFXSSxNQUFYLEVBQW1CQyxhQUFuQixFQUFrQ1EsS0FBbEMsQ0FBYjtBQUNBQyx3QkFBZ0JYLEtBQWhCLEdBQXdCLENBQ3BCO0FBQ0lPLGdCQUFJTixNQURSO0FBRUlPLHVCQUFXTjtBQUZmLFNBRG9CLENBQXhCO0FBTUg7QUFDRCxXQUFPTyxJQUFQO0FBQ0giLCJmaWxlIjoic29ydGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBmbG93XHJcbiAqIEBmaWxlIEZ1bmN0aW9uIHRvIHNvcnQgdGhlIGl0ZW0gbGlzdFxyXG4gKiBAYXV0aG9yIEJveFxyXG4gKi9cclxuXHJcbmltcG9ydCBjb21wYXJhdG9yIGZyb20gJy4vY29tcGFyYXRvcic7XHJcbmltcG9ydCBnZXRCYWRJdGVtRXJyb3IgZnJvbSAnLi9lcnJvcic7XHJcbmltcG9ydCB0eXBlIHsgRmxhdHRlbmVkQm94SXRlbSwgT3JkZXIsIEZsYXR0ZW5lZEJveEl0ZW1Db2xsZWN0aW9uLCBTb3J0QnksIFNvcnREaXJlY3Rpb24gfSBmcm9tICcuLi9mbG93VHlwZXMnO1xyXG5pbXBvcnQgdHlwZSBDYWNoZSBmcm9tICcuL0NhY2hlJztcclxuXHJcbmZ1bmN0aW9uIGlzU29ydGluZ05lZWRlZChvcmRlcj86IE9yZGVyW10sIHNvcnRCeTogU29ydEJ5LCBzb3J0RGlyZWN0aW9uOiBTb3J0RGlyZWN0aW9uKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gIUFycmF5LmlzQXJyYXkob3JkZXIpIHx8ICFvcmRlci5zb21lKChlbnRyeSkgPT4gZW50cnkuYnkgPT09IHNvcnRCeSAmJiBlbnRyeS5kaXJlY3Rpb24gPT09IHNvcnREaXJlY3Rpb24pO1xyXG59XHJcblxyXG4vKipcclxuICogU29ydHMgaXRlbXMgaW4gcGxhY2VcclxuICpcclxuICogQHBhcmFtIHtPYmplY3R9IGl0ZW0gYm94IGl0ZW0gb2JqZWN0XHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBzb3J0Qnkgc29ydCBieSBmaWVsZFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gc29ydERpcmVjdGlvbiB0aGUgc29ydCBkaXJlY3Rpb25cclxuICogQHBhcmFtIHtDYWNoZX0gY2FjaGUgaXRlbSBjYWNoZVxyXG4gKiBAcmV0dXJuIHt2b2lkfVxyXG4gKi9cclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oXHJcbiAgICBpdGVtOiBGbGF0dGVuZWRCb3hJdGVtLFxyXG4gICAgc29ydEJ5OiBTb3J0QnksXHJcbiAgICBzb3J0RGlyZWN0aW9uOiBTb3J0RGlyZWN0aW9uLFxyXG4gICAgY2FjaGU6IENhY2hlXHJcbik6IEZsYXR0ZW5lZEJveEl0ZW0ge1xyXG4gICAgY29uc3QgeyBpdGVtX2NvbGxlY3Rpb24gfTogRmxhdHRlbmVkQm94SXRlbSA9IGl0ZW07XHJcbiAgICBpZiAoIWl0ZW1fY29sbGVjdGlvbikge1xyXG4gICAgICAgIHRocm93IGdldEJhZEl0ZW1FcnJvcigpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHsgZW50cmllcywgb3JkZXIgfTogRmxhdHRlbmVkQm94SXRlbUNvbGxlY3Rpb24gPSBpdGVtX2NvbGxlY3Rpb247XHJcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkoZW50cmllcykpIHtcclxuICAgICAgICB0aHJvdyBnZXRCYWRJdGVtRXJyb3IoKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoaXNTb3J0aW5nTmVlZGVkKG9yZGVyLCBzb3J0QnksIHNvcnREaXJlY3Rpb24pKSB7XHJcbiAgICAgICAgZW50cmllcy5zb3J0KGNvbXBhcmF0b3Ioc29ydEJ5LCBzb3J0RGlyZWN0aW9uLCBjYWNoZSkpO1xyXG4gICAgICAgIGl0ZW1fY29sbGVjdGlvbi5vcmRlciA9IFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgYnk6IHNvcnRCeSxcclxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogc29ydERpcmVjdGlvblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXTtcclxuICAgIH1cclxuICAgIHJldHVybiBpdGVtO1xyXG59XHJcbiJdfQ==